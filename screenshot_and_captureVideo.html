<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>ScreenShot</title>
  <link rel="stylesheet" href="filters.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
</head>
<body>


    <div class="sticky-top" style="background-color: white;">
      <div class="btn-group btn-toolbar">
        <button class="btn btn-outline-primary" id="screenshot"><i class="fas fa-camera"></i></button>
        <button class="btn btn-outline-success" id="captVideo"><i class="fas fa-video"></i></button>
        <button class="btn btn-outline-warning" id="PrevcssFilter">Previous Filter <i class="fas fa-filter"></i></button>
        <button class="btn btn-outline-info" id="NextcssFilter">Next Filter <i class="fas fa-filter"></i></button>
      </div>
    </div>

    <div class="video">
      <center>
        <video autoplay></video>
        <img src="">
        <canvas style="display: none;"></canvas>
      </center>
    </div>


    <script type="text/javascript">


    const video = document.querySelector('video');
    const captVideo = document.querySelector('#captVideo');
    const screenShot = document.querySelector('#screenshot');
    const img = document.querySelector('img');
    const NextcssFilter = document.querySelector('#NextcssFilter');
    const PrevcssFilter = document.querySelector('#PrevcssFilter');

    const canvas = document.createElement("canvas");

    const constraints = {
      video: true
    }

    const hdConstraints = {
      video: {width: {min: 1280}, height: {min: 720}}
    };

    const vgaConstraints = {
      video: {width: {exact: 640}, height: {exact: 480}}
    };

    let filtersIndex = 0;
    const filters = [
      'grayscale',
      'sepia',
      'blur',
      'brightness',
      'contrast',
      'saturate',
      'saturate1',
      'invert',
      'drop-shadow',
      'hue-rotate',
      'hue-rotate1',
      'hue-rotate2',
      ''
    ];


    captVideo.onclick = function() {
        navigator.mediaDevices.getUserMedia(hdConstraints)
            .then(gotStream).catch(errorHandler);
    }

    NextcssFilter.onclick = function() {
      img.className = filters[filtersIndex++ % filters.length];
      video.className = filters[filtersIndex++ % filters.length];
      console.log(img.className);
    };


    PrevcssFilter.onclick = function() {
      img.className = filters[filtersIndex-- % filters.length];
      video.className = filters[filtersIndex-- % filters.length];
      console.log(img.className);
    };

    screenShot.onclick = video.onclick = function () {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      canvas.getContext('2d').drawImage(video, 0, 0);
      // fallback
      img.src = canvas.toDataURL('image/webp');
    }

    function gotStream(stream) {
      window.stream = stream;
      video.srcObject = stream;
    }

    function errorHandler(err) {
      console.error('Error', err);
    }






    </script>

</body>
</html>
